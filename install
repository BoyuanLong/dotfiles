#!/bin/bash

echo "Updating submodules..."
git submodule update --init --recursive
echo "Finished updating submodules"

BASEDIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# dotfiles
echo "====== dotfiles ======"
echo "Linking dotfiles directory..."
if [[ ! -f ~/.dotfiles || -L ~/.dotfiles ]]; then
    ln -s -f ${BASEDIR} ~/.dotfiles
fi

# vim
echo "====== vim ======"
echo "Linking vim files..."
ln -s -f ${BASEDIR}/vim/ ~/.vim

# zsh
echo "====== zsh ======"
if [[ -z $(which zsh) ]]; then
    echo "WARNING: No zsh installed! Please install zsh first"
else
    echo "Linking zsh files..."
    ln -s -f ${BASEDIR}/zsh/zshrc ~/.zshrc
fi

# tmux
echo "====== tmux ======"
if [[ -z $(which tmux) ]]; then
    echo "WARNING: No tmux installed! Please install tmux first"
else
    echo "Linking tmux files..."
    ln -s -f ${BASEDIR}/tmux/tmux.conf ~/.tmux.conf
fi

# git
echo "====== git ======"
echo "Setting up git files..."
gituser=$(git config --global --includes user.name)
gitemail=$(git config --global --includes user.email)
if [[ -z $gituser ]]; then
    read -p 'Git Username: ' gituser
    git config --global user.name "$gituser"
else
    echo "Current git user is: $gituser"
fi

if [[ -z $gitemail ]]; then
    read -p 'Git Email: ' gitemail
    git config --global user.email "$gitemail"
else
    echo "Current git email is: $gitemail"
fi

git config --global core.excludesfile ~/.dotfiles/git/gitignore_global 
git config --global include.path ~/.dotfiles/git/gitconfig 
# ln -s ${BASEDIR}/git/gitconfig ~/.gitconfig
# ln -s ${BASEDIR}/git/gitignore_global ~/.gitignore_global
